(function(e){"use strict";var t=this;var n=t.SpeechRecognition||t.webkitSpeechRecognition||t.mozSpeechRecognition||t.msSpeechRecognition||t.oSpeechRecognition;if(!n){t.scribe=null;return e}var r=location.protocol=="https"?true:false;var i=0;var s="";var o="";var u=0;var a=0;var f=0;var l={permissonPrompt:[],abort:[],start:[],onStart:[],onError:[],onEnd:[],onResult:[],onInterimResult:[],resultMatch:[],resultNoMatch:[],errorNoSpeech:[],errorAborted:[],errorAudioCapture:[],errorNetwork:[],errorPermissionBlocked:[],errorPermissionDenied:[],errorBadGrammer:[]};var c=false;var h;var p;var d=true;var v=true;var m=true;var g=true;var y=false;var b=2;var w="en-GB";var E=function(){return p!==e};var S=function(e,t){e.forEach(function(e){e.callback.apply(e.context,[t])})};var x=function(){if(!E()){t.scribe.init({},false)}};var T=function(e){console.log("Debug: "+e)};t.scribe={init:function(){S(l.permissonPrompt);if(d){T("permissonPrompt")}if(d){T("Init: Please allow microphone access.")}if(p&&p.abort){p.abort()}p=new n;p.maxAlternatives=b;p.interimResults=g;p.continuous=m;p.lang=w;p.onstart=function(e){S(l.onStart);if(d){T("onstart")}};p.onerror=function(e){S(l.onError);switch(e.error){case"no-speech":S(l.errorNoSpeech);if(d){T("error: no-speech")}break;case"aborted":S(l.errorAborted);if(d){T("error: aborted")}break;case"audio-capture":S(l.errorAudioCapture);if(d){T("error: audio-capture")}break;case"network":S(l.errorNetwork);if(d){T("error: network")}break;case"not-allowed":if(d){T("error: not-allowed")};case"service-not-allowed":if(d){T("error: service-not-allowed")}v=false;if((new Date).getTime()-f<200){S(l.errorPermissionBlocked)}else{S(l.errorPermissionDenied)}break;case"bad-grammar":S(l.errorBadGrammer);if(d){T("error: bad-grammar")}break}};p.onend=function(){S(l.onEnd);if(d){T("onend")}if(v){if(!r){S(l.permissonPrompt);if(d){T("permissonPrompt")}}if(d){T("Trying to automagically restart")}var e=(new Date).getTime()-f;if(e<1e3){setTimeout(t.scribe.start,1e3-e)}else{t.scribe.start()}}};p.onresult=function(e){S(l.onResult);if(d){T("onresult")}if(e.results[e.results.length-1].isFinal==false){o=e.results[e.results.length-1][0].transcript.trim();u=e.results[e.results.length-1][0].confidence;S(l.onInterimResult);if(d){T("Processing speech.");T("Interim: "+o+" ("+Math.round(u*100)+"% confidence).")}if(y){S(l.resultMatch,o);p.abort()}}else{s=e.results[e.results.length-1][0].transcript.trim();a=e.results[e.results.length-1][0].confidence;if(d){T(s+" ("+Math.round(a*100)+"% confidence).")}S(l.resultMatch,s)}}},start:function(){S(l.start);x();f=(new Date).getTime();p.start()},abort:function(){S(l.abort);v=false;if(E){p.abort()}},setLanguage:function(e){w=e},enableDebug:function(e){d=e},enableInterimResult:function(e){g=e},enableInterimResultReturn:function(e){y=e},addCallback:function(n,r,i){if(l[n]===e){return}var s=t[r]||r;if(typeof s!=="function"){return}l[n].push({callback:s,context:i||this})}}}).call(this)